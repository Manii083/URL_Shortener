{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/URL_SHORTENER/lib/database.js"],"sourcesContent":["// lib/database.js\r\nimport { Pool } from 'pg';\r\n\r\n// Only create Pool if we're on the server side\r\nlet pool;\r\n\r\nif (typeof window === 'undefined') {\r\n  pool = new Pool({\r\n    connectionString: process.env.DATABASE_URL,\r\n    ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false\r\n  });\r\n}\r\n\r\nexport async function query(text, params) {\r\n  // Only run on server side\r\n  if (typeof window !== 'undefined') {\r\n    throw new Error('Database queries can only be executed on the server side');\r\n  }\r\n\r\n  const client = await pool.connect();\r\n  try {\r\n    const result = await client.query(text, params);\r\n    return result;\r\n  } finally {\r\n    client.release();\r\n  }\r\n}\r\n\r\nexport async function initDB() {\r\n  if (typeof window !== 'undefined') {\r\n    throw new Error('Database initialization can only be done on the server side');\r\n  }\r\n  \r\n  await query(`\r\n    CREATE TABLE IF NOT EXISTS urls (\r\n      id SERIAL PRIMARY KEY,\r\n      slug VARCHAR(10) UNIQUE NOT NULL,\r\n      original_url TEXT NOT NULL,\r\n      clicks INTEGER DEFAULT 0,\r\n      created_at TIMESTAMP DEFAULT NOW()\r\n    );\r\n    CREATE INDEX IF NOT EXISTS idx_slug ON urls(slug);\r\n  `);\r\n}"],"names":[],"mappings":"AAAA,kBAAkB;;;;;;;AAClB;;;;;;AAEA,+CAA+C;AAC/C,IAAI;AAEJ,wCAAmC;IACjC,OAAO,IAAI,4GAAI,CAAC;QACd,kBAAkB,QAAQ,GAAG,CAAC,YAAY;QAC1C,KAAK,sCAAwC,0BAAgC;IAC/E;AACF;AAEO,eAAe,MAAM,IAAI,EAAE,MAAM;IACtC,0BAA0B;IAC1B;;IAIA,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO;IACT,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe;IACpB;;IAIA,MAAM,MAAM,CAAC;;;;;;;;;EASb,CAAC;AACH"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/URL_SHORTENER/pages/%5Bslug%5D.js"],"sourcesContent":["// pages/[slug].js\r\nimport { query } from '../lib/database';\r\nimport { useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\n\r\n// This runs on the server side\r\nexport async function getServerSideProps(context) {\r\n  const { slug } = context.params;\r\n\r\n  try {\r\n    // Get the original URL from database\r\n    const result = await query(\r\n      'SELECT original_url FROM urls WHERE slug = $1',\r\n      [slug]\r\n    );\r\n\r\n    if (result.rows.length === 0) {\r\n      return {\r\n        props: {\r\n          error: 'URL not found',\r\n          slug\r\n        }\r\n      };\r\n    }\r\n\r\n    // Update click count\r\n    await query(\r\n      'UPDATE urls SET clicks = clicks + 1 WHERE slug = $1',\r\n      [slug]\r\n    );\r\n\r\n    // Return the original URL for redirect\r\n    return {\r\n      props: {\r\n        originalUrl: result.rows[0].original_url,\r\n        slug\r\n      }\r\n    };\r\n  } catch (error) {\r\n    console.error('Redirect error:', error);\r\n    return {\r\n      props: {\r\n        error: 'Failed to redirect',\r\n        slug\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\nexport default function RedirectPage({ originalUrl, error, slug }) {\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    if (originalUrl) {\r\n      // Client-side redirect\r\n      window.location.href = originalUrl;\r\n    }\r\n  }, [originalUrl]);\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <Head>\r\n          <title>Error - URL Not Found</title>\r\n        </Head>\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8 text-center\">\r\n          <div className=\"text-red-500 text-6xl mb-4\">⚠️</div>\r\n          <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">URL Not Found</h1>\r\n          <p className=\"text-gray-600 mb-4\">The shortened URL <code className=\"bg-gray-100 px-2 py-1 rounded\">/{slug}</code> does not exist.</p>\r\n          <a \r\n            href=\"/\" \r\n            className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200\"\r\n          >\r\n            Shorten New URL\r\n          </a>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n      <Head>\r\n        <title>Redirecting...</title>\r\n      </Head>\r\n      <div className=\"bg-white rounded-xl shadow-lg p-8 text-center\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n        <p className=\"text-gray-600\">Redirecting to your destination...</p>\r\n        <p className=\"text-sm text-gray-500 mt-2\">If you are not redirected automatically, <a href={originalUrl} className=\"text-blue-600 hover:underline\">click here</a>.</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,kBAAkB;;;;;;;;AAClB;AACA;AACA;AACA;;;;;;;;;;AAGO,eAAe,mBAAmB,OAAO;IAC9C,MAAM,EAAE,IAAI,EAAE,GAAG,QAAQ,MAAM;IAE/B,IAAI;QACF,qCAAqC;QACrC,MAAM,SAAS,MAAM,IAAA,iHAAK,EACxB,iDACA;YAAC;SAAK;QAGR,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,GAAG;YAC5B,OAAO;gBACL,OAAO;oBACL,OAAO;oBACP;gBACF;YACF;QACF;QAEA,qBAAqB;QACrB,MAAM,IAAA,iHAAK,EACT,uDACA;YAAC;SAAK;QAGR,uCAAuC;QACvC,OAAO;YACL,OAAO;gBACL,aAAa,OAAO,IAAI,CAAC,EAAE,CAAC,YAAY;gBACxC;YACF;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO;YACL,OAAO;gBACL,OAAO;gBACP;YACF;QACF;IACF;AACF;AAEe,SAAS,aAAa,EAAE,WAAW,EAAE,KAAK,EAAE,IAAI,EAAE;IAC/D,MAAM,SAAS,IAAA,oIAAS;IAExB,IAAA,gHAAS,EAAC;QACR,IAAI,aAAa;YACf,uBAAuB;YACvB,OAAO,QAAQ,CAAC,IAAI,GAAG;QACzB;IACF,GAAG;QAAC;KAAY;IAEhB,IAAI,OAAO;QACT,qBACE,qKAAC;YAAI,WAAU;;8BACb,qKAAC,gIAAI;8BACH,cAAA,qKAAC;kCAAM;;;;;;;;;;;8BAET,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAI,WAAU;sCAA6B;;;;;;sCAC5C,qKAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,qKAAC;4BAAE,WAAU;;gCAAqB;8CAAkB,qKAAC;oCAAK,WAAU;;wCAAgC;wCAAE;;;;;;;gCAAY;;;;;;;sCAClH,qKAAC;4BACC,MAAK;4BACL,WAAU;sCACX;;;;;;;;;;;;;;;;;;IAMT;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC,gIAAI;0BACH,cAAA,qKAAC;8BAAM;;;;;;;;;;;0BAET,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAI,WAAU;;;;;;kCACf,qKAAC;wBAAE,WAAU;kCAAgB;;;;;;kCAC7B,qKAAC;wBAAE,WAAU;;4BAA6B;0CAAyC,qKAAC;gCAAE,MAAM;gCAAa,WAAU;0CAAgC;;;;;;4BAAc;;;;;;;;;;;;;;;;;;;AAIzK"}}]
}
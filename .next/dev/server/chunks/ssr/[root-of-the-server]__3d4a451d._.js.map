{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/URL_SHORTENER/lib/database.js"],"sourcesContent":["import { Pool } from 'pg';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nconst pool = new Pool({\r\n  connectionString: process.env.DATABASE_URL,\r\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false\r\n});\r\n\r\nexport async function query(text, params) {\r\n  const client = await pool.connect();\r\n  try {\r\n    const result = await client.query(text, params);\r\n    return result;\r\n  } finally {\r\n    client.release();\r\n  }\r\n}\r\n\r\nexport async function initDB() {\r\n  await query(`\r\n    CREATE TABLE IF NOT EXISTS urls (\r\n      id SERIAL PRIMARY KEY,\r\n      slug VARCHAR(10) UNIQUE NOT NULL,\r\n      original_url TEXT NOT NULL,\r\n      clicks INTEGER DEFAULT 0,\r\n      created_at TIMESTAMP DEFAULT NOW()\r\n    );\r\n    CREATE INDEX IF NOT EXISTS idx_slug ON urls(slug);\r\n  `);\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAEA,gHAAM,CAAC,MAAM;AAEb,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAM,IAAI,EAAE,MAAM;IACtC,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO;IACT,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe;IACpB,MAAM,MAAM,CAAC;;;;;;;;;EASb,CAAC;AACH"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///C:/URL_SHORTENER/pages/%5Bslug%5D.js"],"sourcesContent":["import { query } from '../lib/database';\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport Head from 'next/head';\r\n\r\nexport default function RedirectPage() {\r\n  const router = useRouter();\r\n  const { slug } = router.query;\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (!slug) return;\r\n\r\n    const redirectToUrl = async () => {\r\n      try {\r\n        // First, update the click count\r\n        await query(\r\n          'UPDATE urls SET clicks = clicks + 1 WHERE slug = $1',\r\n          [slug]\r\n        );\r\n\r\n        // Then get the original URL\r\n        const result = await query(\r\n          'SELECT original_url FROM urls WHERE slug = $1',\r\n          [slug]\r\n        );\r\n\r\n        if (result.rows.length === 0) {\r\n          setError('URL not found');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Redirect to the original URL\r\n        window.location.href = result.rows[0].original_url;\r\n        \r\n      } catch (error) {\r\n        console.error('Redirect error:', error);\r\n        setError('Failed to redirect');\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    redirectToUrl();\r\n  }, [slug]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <Head>\r\n          <title>Redirecting...</title>\r\n        </Head>\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8 text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Redirecting...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <Head>\r\n          <title>Error - URL Not Found</title>\r\n        </Head>\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8 text-center\">\r\n          <div className=\"text-red-500 text-6xl mb-4\">⚠️</div>\r\n          <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">URL Not Found</h1>\r\n          <p className=\"text-gray-600 mb-4\">The shortened URL <code className=\"bg-gray-100 px-2 py-1 rounded\">/{slug}</code> does not exist.</p>\r\n          <a \r\n            href=\"/\" \r\n            className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200\"\r\n          >\r\n            Shorten New URL\r\n          </a>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n}"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,oIAAS;IACxB,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,KAAK;IAC7B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IAEnC,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,MAAM;QAEX,MAAM,gBAAgB;YACpB,IAAI;gBACF,gCAAgC;gBAChC,MAAM,IAAA,iHAAK,EACT,uDACA;oBAAC;iBAAK;gBAGR,4BAA4B;gBAC5B,MAAM,SAAS,MAAM,IAAA,iHAAK,EACxB,iDACA;oBAAC;iBAAK;gBAGR,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,GAAG;oBAC5B,SAAS;oBACT,WAAW;oBACX;gBACF;gBAEA,+BAA+B;gBAC/B,OAAO,QAAQ,CAAC,IAAI,GAAG,OAAO,IAAI,CAAC,EAAE,CAAC,YAAY;YAEpD,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,mBAAmB;gBACjC,SAAS;gBACT,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;KAAK;IAET,IAAI,SAAS;QACX,qBACE,qKAAC;YAAI,WAAU;;8BACb,qKAAC,gIAAI;8BACH,cAAA,qKAAC;kCAAM;;;;;;;;;;;8BAET,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAI,WAAU;;;;;;sCACf,qKAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;;;;;;;IAIrC;IAEA,IAAI,OAAO;QACT,qBACE,qKAAC;YAAI,WAAU;;8BACb,qKAAC,gIAAI;8BACH,cAAA,qKAAC;kCAAM;;;;;;;;;;;8BAET,qKAAC;oBAAI,WAAU;;sCACb,qKAAC;4BAAI,WAAU;sCAA6B;;;;;;sCAC5C,qKAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,qKAAC;4BAAE,WAAU;;gCAAqB;8CAAkB,qKAAC;oCAAK,WAAU;;wCAAgC;wCAAE;;;;;;;gCAAY;;;;;;;sCAClH,qKAAC;4BACC,MAAK;4BACL,WAAU;sCACX;;;;;;;;;;;;;;;;;;IAMT;IAEA,OAAO;AACT"}}]
}